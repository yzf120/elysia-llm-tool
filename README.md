[//]: # (# LLM Tool - ç»Ÿä¸€å¤§æ¨¡å‹æ¥å…¥æœåŠ¡)

[//]: # ()
[//]: # (## é¡¹ç›®ç®€ä»‹)

[//]: # ()
[//]: # (llm-tool æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„å¤§æ¨¡å‹èƒ½åŠ›æ¥å…¥æœåŠ¡ï¼Œä¸ºä¸Šå±‚æœåŠ¡æä¾›ç»Ÿä¸€çš„ StreamChat æ–¹æ³•ï¼ˆé€šè¿‡ tRPC çš„ RPC èŒƒå¼è°ƒç”¨ï¼‰ã€‚)

[//]: # ()
[//]: # (ç›®å‰æ”¯æŒçš„æ¨¡å‹æä¾›å•†ï¼š)

[//]: # (- âœ… **è±†åŒ…ï¼ˆDoubaoï¼‰** - å­—èŠ‚è·³åŠ¨ç«å±±å¼•æ“)

[//]: # (- âœ… **æ··å…ƒï¼ˆHunyuanï¼‰** - è…¾è®¯äº‘)

[//]: # (- ğŸš§ **DeepSeek** - å¾…å®ç°)

[//]: # ()
[//]: # (## é¡¹ç›®æ¶æ„)

[//]: # ()
[//]: # (```)

[//]: # (llm-tool/)

[//]: # (â”œâ”€â”€ client/              # ç¬¬ä¸‰æ–¹ SDK å®¢æˆ·ç«¯å°è£…)

[//]: # (â”‚   â”œâ”€â”€ doubao_client.go    # è±†åŒ…å®¢æˆ·ç«¯)

[//]: # (â”‚   â”œâ”€â”€ hunyuan_client.go   # æ··å…ƒå®¢æˆ·ç«¯)

[//]: # (â”‚   â””â”€â”€ deepseek_client.go  # DeepSeekå®¢æˆ·ç«¯)

[//]: # (â”œâ”€â”€ service/             # ä¸šåŠ¡é€»è¾‘å±‚)

[//]: # (â”‚   â”œâ”€â”€ llm_service.go      # é€šç”¨æœåŠ¡ï¼ˆè·¯ç”±ã€æ¨¡å‹åˆ—è¡¨ï¼‰)

[//]: # (â”‚   â”œâ”€â”€ doubao_service.go   # è±†åŒ…ä¸šåŠ¡é€»è¾‘)

[//]: # (â”‚   â””â”€â”€ hunyuan_service.go  # æ··å…ƒä¸šåŠ¡é€»è¾‘)

[//]: # (â”œâ”€â”€ service_impl/        # RPC å®ç°å±‚)

[//]: # (â”‚   â””â”€â”€ llm_service_impl.go # RPC æ¥å£å®ç°)

[//]: # (â”œâ”€â”€ proto/               # Protocol Buffers å®šä¹‰)

[//]: # (â”‚   â””â”€â”€ llm/)

[//]: # (â”‚       â””â”€â”€ llm.proto       # æœåŠ¡æ¥å£å®šä¹‰)

[//]: # (â”œâ”€â”€ config/              # é…ç½®ç®¡ç†)

[//]: # (â”‚   â””â”€â”€ config.go)

[//]: # (â”œâ”€â”€ consts/              # å¸¸é‡å®šä¹‰)

[//]: # (â”‚   â””â”€â”€ base.go)

[//]: # (â”œâ”€â”€ errs/                # é”™è¯¯å¤„ç†)

[//]: # (â”‚   â””â”€â”€ errs.go)

[//]: # (â””â”€â”€ main.go              # æœåŠ¡å…¥å£)

[//]: # (```)

[//]: # ()
[//]: # (### åˆ†å±‚è¯´æ˜)

[//]: # ()
[//]: # (1. **service_impl å±‚**ï¼šæ¥æ”¶ RPC è¯·æ±‚ï¼Œæ ¹æ® modelId è·¯ç”±åˆ°å¯¹åº”çš„ service)

[//]: # (2. **service å±‚**ï¼šå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œè°ƒç”¨ç¬¬ä¸‰æ–¹ SDKï¼Œè¿›è¡Œå‚æ•°è½¬æ¢å’Œé”™è¯¯å¤„ç†)

[//]: # (3. **client å±‚**ï¼šå°è£…ç¬¬ä¸‰æ–¹ SDK å®¢æˆ·ç«¯ï¼Œæä¾›å•ä¾‹æ¨¡å¼)

[//]: # ()
[//]: # (## å¿«é€Ÿå¼€å§‹)

[//]: # ()
[//]: # (### 1. ç¯å¢ƒå‡†å¤‡)

[//]: # ()
[//]: # (```bash)

[//]: # (# å®‰è£… Go 1.21+)

[//]: # (go version)

[//]: # ()
[//]: # (# å…‹éš†é¡¹ç›®)

[//]: # (cd elysia-llm-tool)

[//]: # ()
[//]: # (# å®‰è£…ä¾èµ–)

[//]: # (go mod tidy)

[//]: # (```)

[//]: # ()
[//]: # (### 2. é…ç½®ç¯å¢ƒå˜é‡)

[//]: # ()
[//]: # (å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶å¡«å†™é…ç½®ï¼š)

[//]: # ()
[//]: # (```bash)

[//]: # (cp .env.example .env)

[//]: # (```)

[//]: # ()
[//]: # (ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š)

[//]: # ()
[//]: # (```bash)

[//]: # (# è±†åŒ…é…ç½®)

[//]: # (DOUBAO_API_KEY=your_doubao_api_key_here)

[//]: # (DOUBAO_BASE_URL=https://ark.cn-beijing.volces.com/api/v3)

[//]: # ()
[//]: # (# è…¾è®¯äº‘æ··å…ƒé…ç½®)

[//]: # (TENCENTCLOUD_SECRET_ID=your_tencentcloud_secret_id_here)

[//]: # (TENCENTCLOUD_SECRET_KEY=your_tencentcloud_secret_key_here)

[//]: # ()
[//]: # (# æ¨¡å‹é»˜è®¤å‚æ•°é…ç½®)

[//]: # (DEFAULT_TEMPERATURE=0.7)

[//]: # (DEFAULT_MAX_TOKENS=2000)

[//]: # (DEFAULT_TOP_P=0.9)

[//]: # (```)

[//]: # ()
[//]: # (### 3. ç”Ÿæˆ Proto ä»£ç )

[//]: # ()
[//]: # (```bash)

[//]: # (cd proto)

[//]: # (make)

[//]: # (```)

[//]: # ()
[//]: # (### 4. ç¼–è¯‘è¿è¡Œ)

[//]: # ()
[//]: # (```bash)

[//]: # (# ç¼–è¯‘)

[//]: # (go build -o llm-tool .)

[//]: # ()
[//]: # (# è¿è¡Œ)

[//]: # (./llm-tool)

[//]: # (```)

[//]: # ()
[//]: # (æˆ–è€…ä½¿ç”¨ Makefileï¼š)

[//]: # ()
[//]: # (```bash)

[//]: # (make run)

[//]: # (```)

[//]: # ()
[//]: # (## API ä½¿ç”¨)

[//]: # ()
[//]: # (### 1. æµå¼å¯¹è¯ï¼ˆStreamChatï¼‰)

[//]: # ()
[//]: # (**è¯·æ±‚å‚æ•°ï¼š**)

[//]: # ()
[//]: # (```protobuf)

[//]: # (message StreamChatRequest {)

[//]: # (  string model_id = 1;                    // æ¨¡å‹IDï¼ˆå¿…å¡«ï¼‰)

[//]: # (  repeated ChatMessage messages = 2;       // å¯¹è¯æ¶ˆæ¯åˆ—è¡¨)

[//]: # (})

[//]: # ()
[//]: # (message ChatMessage {)

[//]: # (  string role = 1;                         // è§’è‰²ï¼šuser/assistant/system)

[//]: # (  repeated ContentPart content = 2;        // æ¶ˆæ¯å†…å®¹ï¼ˆæ”¯æŒå¤šæ¨¡æ€ï¼‰)

[//]: # (})

[//]: # ()
[//]: # (message ContentPart {)

[//]: # (  string type = 1;                         // ç±»å‹ï¼štext/image_url)

[//]: # (  string text = 2;                         // æ–‡æœ¬å†…å®¹)

[//]: # (  ImageUrl image_url = 3;                  // å›¾ç‰‡URL)

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (**å“åº”ï¼š**)

[//]: # ()
[//]: # (```protobuf)

[//]: # (message StreamChatResponse {)

[//]: # (  string id = 1;                           // å“åº”ID)

[//]: # (  string model = 2;                        // æ¨¡å‹åç§°)

[//]: # (  int64 created = 3;                       // åˆ›å»ºæ—¶é—´æˆ³)

[//]: # (  repeated Choice choices = 4;             // é€‰æ‹©åˆ—è¡¨)

[//]: # (  Usage usage = 5;                         // Tokenä½¿ç”¨æƒ…å†µ)

[//]: # (  bool is_end = 6;                         // æ˜¯å¦ç»“æŸ)

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (### 2. è·å–æ¨¡å‹åˆ—è¡¨ï¼ˆListModelsï¼‰)

[//]: # ()
[//]: # (**è¯·æ±‚å‚æ•°ï¼š**)

[//]: # ()
[//]: # (```protobuf)

[//]: # (message ListModelsRequest {)

[//]: # (  string provider = 1;  // æä¾›å•†è¿‡æ»¤ï¼ˆå¯é€‰ï¼‰ï¼šdoubao/hunyuan/deepseek)

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (**å“åº”ï¼š**)

[//]: # ()
[//]: # (```protobuf)

[//]: # (message ListModelsResponse {)

[//]: # (  repeated ModelInfo models = 1;)

[//]: # (})

[//]: # ()
[//]: # (message ModelInfo {)

[//]: # (  string model_id = 1;        // æ¨¡å‹ID)

[//]: # (  string model_name = 2;      // æ¨¡å‹åç§°)

[//]: # (  string provider = 3;        // æä¾›å•†)

[//]: # (  string description = 4;     // æè¿°)

[//]: # (  bool support_stream = 5;    // æ˜¯å¦æ”¯æŒæµå¼)

[//]: # (  bool support_vision = 6;    // æ˜¯å¦æ”¯æŒè§†è§‰)

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (## æ”¯æŒçš„æ¨¡å‹)

[//]: # ()
[//]: # (### è±†åŒ…ï¼ˆDoubaoï¼‰)

[//]: # ()
[//]: # (| æ¨¡å‹ID | æ¨¡å‹åç§° | æè¿° | æµå¼ | å¤šæ¨¡æ€ |)

[//]: # (|--------|---------|------|------|--------|)

[//]: # (| doubao-seed-1-6-lite-251015 | è±†åŒ… Seed 1.6 Lite | è½»é‡çº§æ¨¡å‹ï¼Œé€‚åˆå¿«é€Ÿå“åº” | âœ… | âœ… |)

[//]: # ()
[//]: # (### æ··å…ƒï¼ˆHunyuanï¼‰)

[//]: # ()
[//]: # (| æ¨¡å‹ID | æ¨¡å‹åç§° | æè¿° | æµå¼ | å¤šæ¨¡æ€ |)

[//]: # (|--------|---------|------|------|--------|)

[//]: # (| hunyuan-turbos-latest | æ··å…ƒ Turbos Latest | è…¾è®¯æ··å…ƒæœ€æ–°æ¨¡å‹ | âœ… | âœ… |)

[//]: # ()
[//]: # (## å¼€å‘æŒ‡å—)

[//]: # ()
[//]: # (### æ·»åŠ æ–°çš„æ¨¡å‹æä¾›å•†)

[//]: # ()
[//]: # (1. **åˆ›å»º client**ï¼šåœ¨ `client/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„å®¢æˆ·ç«¯æ–‡ä»¶)

[//]: # (2. **åˆ›å»º service**ï¼šåœ¨ `service/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„æœåŠ¡æ–‡ä»¶)

[//]: # (3. **æ›´æ–°è·¯ç”±**ï¼šåœ¨ `service/llm_service.go` ä¸­æ›´æ–° `GetProviderFromModelID` æ–¹æ³•)

[//]: # (4. **æ›´æ–° impl**ï¼šåœ¨ `service_impl/llm_service_impl.go` ä¸­æ·»åŠ æ–°çš„ case)

[//]: # (5. **æ›´æ–°æ¨¡å‹åˆ—è¡¨**ï¼šåœ¨ `service/llm_service.go` çš„ `ListModels` æ–¹æ³•ä¸­æ·»åŠ æ¨¡å‹ä¿¡æ¯)

[//]: # ()
[//]: # (### ç¤ºä¾‹ï¼šæ·»åŠ  DeepSeek)

[//]: # ()
[//]: # (```go)

[//]: # (// 1. client/deepseek_client.go)

[//]: # (func GetDeepSeekClient&#40;&#41; *deepseek.Client {)

[//]: # (    // å®ç°å®¢æˆ·ç«¯å•ä¾‹)

[//]: # (})

[//]: # ()
[//]: # (// 2. service/deepseek_service.go)

[//]: # (type DeepSeekService struct {)

[//]: # (    cfg *config.Config)

[//]: # (})

[//]: # ()
[//]: # (func &#40;s *DeepSeekService&#41; StreamChat&#40;ctx context.Context, req *pb.StreamChatRequest, stream pb.LLMService_StreamChatServer&#41; error {)

[//]: # (    // å®ç°æµå¼å¯¹è¯é€»è¾‘)

[//]: # (})

[//]: # ()
[//]: # (// 3. service/llm_service.go)

[//]: # (func &#40;s *LLMService&#41; GetDeepSeekService&#40;&#41; *DeepSeekService {)

[//]: # (    return s.deepseekService)

[//]: # (})

[//]: # ()
[//]: # (// 4. service_impl/llm_service_impl.go)

[//]: # (case "deepseek":)

[//]: # (    return s.llmService.GetDeepSeekService&#40;&#41;.StreamChat&#40;ctx, req, stream&#41;)

[//]: # (```)

[//]: # ()
[//]: # (## é…ç½®è¯´æ˜)

[//]: # ()
[//]: # (### ç¯å¢ƒå˜é‡)

[//]: # ()
[//]: # (| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |)

[//]: # (|--------|------|--------|)

[//]: # (| DOUBAO_API_KEY | è±†åŒ… API Key | - |)

[//]: # (| DOUBAO_BASE_URL | è±†åŒ… API åœ°å€ | https://ark.cn-beijing.volces.com/api/v3 |)

[//]: # (| TENCENTCLOUD_SECRET_ID | è…¾è®¯äº‘ Secret ID | - |)

[//]: # (| TENCENTCLOUD_SECRET_KEY | è…¾è®¯äº‘ Secret Key | - |)

[//]: # (| DEFAULT_TEMPERATURE | é»˜è®¤æ¸©åº¦å‚æ•° | 0.7 |)

[//]: # (| DEFAULT_MAX_TOKENS | é»˜è®¤æœ€å¤§ Token æ•° | 2000 |)

[//]: # (| DEFAULT_TOP_P | é»˜è®¤ Top P å‚æ•° | 0.9 |)

[//]: # ()
[//]: # (### tRPC é…ç½®)

[//]: # ()
[//]: # (æœåŠ¡é…ç½®åœ¨ `trpc_go.yaml` ä¸­ï¼Œé»˜è®¤ç›‘å¬ç«¯å£ï¼š)

[//]: # (- RPC ç«¯å£ï¼š8000)

[//]: # (- HTTP ç«¯å£ï¼š8080)

[//]: # ()
[//]: # (## é”™è¯¯å¤„ç†)

[//]: # ()
[//]: # (é”™è¯¯ç å®šä¹‰åœ¨ `consts/base.go` å’Œ `errs/errs.go` ä¸­ï¼š)

[//]: # ()
[//]: # (| é”™è¯¯ç  | è¯´æ˜ |)

[//]: # (|--------|------|)

[//]: # (| 10001 | æ¨¡å‹IDæ— æ•ˆ |)

[//]: # (| 10002 | æ¶ˆæ¯åˆ—è¡¨ä¸ºç©º |)

[//]: # (| 10003 | æ¨¡å‹æä¾›å•†ä¸æ”¯æŒ |)

[//]: # (| 10004 | æ¨¡å‹è¯·æ±‚å¤±è´¥ |)

[//]: # (| 10005 | æ¨¡å‹æµå¼å“åº”å¤±è´¥ |)

[//]: # ()
[//]: # (## æµ‹è¯•)

[//]: # ()
[//]: # (```bash)

[//]: # (# è¿è¡Œæµ‹è¯•)

[//]: # (go test ./...)

[//]: # ()
[//]: # (# è¿è¡Œç‰¹å®šåŒ…çš„æµ‹è¯•)

[//]: # (go test ./service/...)

[//]: # (```)

[//]: # ()
[//]: # (## éƒ¨ç½²)

[//]: # ()
[//]: # (### Docker éƒ¨ç½²)

[//]: # ()
[//]: # (```bash)

[//]: # (# æ„å»ºé•œåƒ)

[//]: # (docker build -t llm-tool:latest .)

[//]: # ()
[//]: # (# è¿è¡Œå®¹å™¨)

[//]: # (docker run -d \)

[//]: # (  --name llm-tool \)

[//]: # (  -p 8000:8000 \)

[//]: # (  -p 8080:8080 \)

[//]: # (  --env-file .env \)

[//]: # (  llm-tool:latest)

[//]: # (```)

[//]: # ()
[//]: # (### Kubernetes éƒ¨ç½²)

[//]: # ()
[//]: # (```bash)

[//]: # (# åº”ç”¨é…ç½®)

[//]: # (kubectl apply -f k8s/deployment.yaml)

[//]: # (kubectl apply -f k8s/service.yaml)

[//]: # (```)

[//]: # ()
[//]: # (## è®¸å¯è¯)

[//]: # ()
[//]: # (MIT License)

[//]: # ()
[//]: # (## è´¡çŒ®)

[//]: # ()
[//]: # (æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼)
